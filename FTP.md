#Установка FTP сервера
dnf install proftpd
dnf install proftpd-utils
#Запуск сервиса proftpd и добавление его в автозагрузку
systemctl enable --now proftpd
#После запуска службы proftpd, FTP-сервер сразу готов предоставлять доступ с аутентификацией от имен
существующих локальных пользователей данного сервера.
#При этом предоставляется полный доступ к домашней директории пользователя.

#Активации анонимного доступа
#Для активации анонимного доступа необходимо добавьте параметр PROFTPD_OPTIONS="-DANONYMOUS_FTP" в
файл /etc/sysconfig/proftpd.
vi /etc/sysconfig/proftpd

#Сервер proftpd сопоставляет анонимных клиентов (anonymous) с пользователем FTP.
#Пользователь с логином FTP имеет оболочку /sbin/nologin, которая на самом деле не является оболочкой
(shell), и такому пользователю будет запрещено запускать сеанс командой строки. Однако его можно
использовать в качестве пользователя на FTP-сервере.
#Добавляем ложную оболочку /sbin/nologin в файл списка оболочек /etc/shells.
echo /sbin/nologin >> /etc/shells
#Перезапускаем службу proftpd для применения настроек
systemctl restart proftpd
#При подключении анонимному пользователю доступны два каталога — pub и uploads, которые находятся в
корневой директории FTP-сервера /var/ftp/.
#Директория /pub – общедоступный каталог FTP, который имеет права только на чтение.
#Директория /uploads – имеет права на запись, но при этом просматривать содержимое директории запрещено.

#Определим другое расположение файлов для анонимного доступа по FTP изменив домашнюю директорию
пользователя ftp
mkdir -p /srv/routers-conf
chown ftp:ftp /srv/routers-conf
chmod 700 /srv/routers-conf
usermod -d /srv/routers-conf ftp

#Разрешим запись в корневой каталог анонимного пользователя
vi /etc/proftpd/anonftp.conf

<Limit WRITE SITE_CHMOD>
    AllowAll
</Limit>

#Перезапускаем службу proftpd для применения настроек
systemctl restart proftpd

#Сохранение конфигурации маршрутизатора на базе EcoRouter
copy startup-config ftp ftp://192.168.33.2/27-06-2024_R-DT

#Сохранение конфигурации маршрутизатора на базе vESR
confgure
archive
path ftp://192.168.33.2:/$H-$T
time-period 10080
auto
by-commit
exit
#после чего необходимо сделать commit и confirm, чтобы сохранить конфигурацию
где:
time-period - это период времени в минутах, указывающий как часто нужно автоматически сохранять конфигурацию
(независимо от изменений). В нашем случае - каждые 10080 минут (1 неделя).
auto - включает режим отправки файла конфигурации на сервер резервирования через указанный промежуток
времени (промежуток задается через time-period).
by-commit - включает режим отправки файла конфигурации на сервер резервирования после удачного применения
конфигурации (т.е. каждая команда commit применяет параметры и уже после их успешного применения сохраняет
резервную копию конфигурации на FTP сервер).
